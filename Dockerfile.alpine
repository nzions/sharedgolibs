# Test waitlib in Alpine container
FROM golang:1.23-alpine AS builder

WORKDIR /app
COPY . .

# Build the waitlib binary
RUN go build -o waitlib-alpine ./cmd/waitlib/

# Alpine runtime stage
FROM alpine:latest

# Install ps command for testing
RUN apk --no-cache add procps

WORKDIR /root/
COPY --from=builder /app/waitlib-alpine ./waitlib

# Set the command to run waitlib
CMD ["./waitlib"]
